<!DOCTYPE html>
<html lang="en">
<head>

<!--==========================
      [META & PROJECT INFO]

1>index.html~
2>CSS/style.css~
3>JS/API/cloudinary.js~
4>JS/API/firebase.js~
5>JS/API/jikan.js~
6>JS/API/utils.js~
7>JS/Page/chat.js~
8>JS/Page/home.js~
9>JS/Page/polls.js~
10>JS/Page/profile.js~
11>JS/Page/watchlist.js~
12>JS/Security/logic.js~
13>JS/Security/rule.js~
14>JS/System/auth.js~
15>JS/System/setting.js~
16>JS/Z-Integration/app.js~
17>JS/Z-Integration/main.js~
18>JS/Z-Integration/system.js~
==========================-->

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AnimeExplorer</title>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

<!-- =========================
   -----<[{( 2 )}]>-----
------------------------------
        <~INDEX.HTML~>
         (Structure)
------------------------------
     -------NEXT-------
==========================-->

    <!-- Login Page -->
    <div id="loginPage">
        <div class="login-container">
            <div class="login-logo">AnimeExplorer</div>
            <div class="login-card">
                <h2 id="formTitle" style="margin-bottom: 8px;">Welcome Back!</h2>
                <p style="color: var(--text-muted); font-size: 14px; margin-bottom: 25px;" id="formSubtitle">
                    Sign in to sync your watchlist and chat.
                </p>
                <div id="errorMessage" class="error-message hidden"></div>
                <!-- Email/Password Form -->
                <div id="emailForm" class="email-form">
                    <!-- Signup Only Fields -->
                    <div class="signup-only">
                        <div class="form-group">
                            <label class="form-label">Profile Photo</label>
                            <input type="file" id="signupPhoto" accept="image/*" class="form-input" style="padding: 10px; border: 1px dashed #ccc;">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Full Name</label>
                            <input type="text" id="signupName" class="form-input" placeholder="e.g. John Doe">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Username</label>
                            <input type="text" id="signupUsername" class="form-input" placeholder="e.g. otaku_king">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Email Address</label>
                        <input type="email" id="emailInput" class="form-input" placeholder="your@email.com">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <input type="password" id="passwordInput" class="form-input" placeholder="••••••••">
                    </div>
                    <button id="emailSubmitBtn" class="email-btn">Sign In</button>
                    <div class="toggle-form">
                        <div style="margin-bottom: 10px;">
                            <span id="toggleText">Don't have an account?</span> <a href="#" id="toggleFormLink">Sign Up</a>
                        </div>
                        <a href="#" id="forgotPasswordLink" style="font-size: 12px; color: var(--text-muted);">Forgot Password?</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App Container -->
    <div id="appContainer">
        <!-- Header -->
        <header class="app-header" id="mainHeader">
            <div class="logo" id="headerTitle">AnimeExplorer</div>
            <div id="headerActions"></div>
        </header>

        <!-- Main Content Area -->
        <div id="mainContent">
            <!-- Home Page -->
            <div id="homePage" class="page active">
                <div class="page-container">
                    <input type="text" id="searchInput" class="search-box" placeholder="Search anime...">
                    <!-- Filter Categories -->
                    <div class="filter-container" style="margin: 20px 0;">
                        <button class="filter-btn active" id="btn-trending" onclick="window.switchHomeTab('trending')">
                            <i class="fa-solid fa-fire"></i> Trending
                        </button>
                        <button class="filter-btn" id="btn-new" onclick="window.switchHomeTab('new')">
                            <i class="fa-solid fa-calendar-check"></i> New
                        </button>
                        <button class="filter-btn" id="btn-upcoming" onclick="window.switchHomeTab('upcoming')">
                            <i class="fa-solid fa-hourglass-start"></i> Coming Soon
                        </button>
                        <button class="filter-btn" id="btn-all" onclick="window.switchHomeTab('all')">
                            <i class="fa-solid fa-globe"></i> All
                        </button>
                    </div>
                    <h3 id="sectionTitle" style="margin: 10px 0 15px 5px; color: var(--text-heading); font-size: 18px;">Trending Now</h3>
                    <div id="loading" class="text-center"><i class="fa-solid fa-spinner fa-spin" style="font-size:30px; color:var(--primary);"></i></div>
                    <div id="animeGrid" class="grid-container"></div>
                    <!-- Pagination Controls -->
                    <div id="paginationControls" class="text-center hidden" style="margin-top: 30px; padding-bottom: 20px; display: flex; justify-content: center; gap: 15px; align-items: center;">
                        <button id="prevPageBtn" class="btn-primary" style="width: auto; padding: 10px 20px; background: #e0e0e0; color: #333; display: none; box-shadow:none;">
                            <i class="fa-solid fa-chevron-left"></i> Prev
                        </button>
                        <span id="pageIndicator" style="color: var(--text-muted); font-size: 14px; font-weight:600;">Page 1</span>
                        <button id="nextPageBtn" class="btn-primary" style="width: auto; padding: 10px 20px;">
                            Next <i class="fa-solid fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Details Page -->
            <div id="detailsPage" class="page">
                <div class="page-container" style="padding: 0;">
                    <a id="backButton" href="javascript:void(0)" class="back-btn"><i class="fa-solid fa-arrow-left"></i></a>
                    <div id="detailsLoading">
                        <div style="height: 100vh; display: flex; justify-content: center; align-items: center;">
                            <i class="fa-solid fa-circle-notch fa-spin" style="font-size: 40px; color: var(--primary);"></i>
                        </div>
                    </div>
                    <div id="detailsContent" class="hidden">
                        <div class="banner-container">
                            <img id="banner" class="banner-img" src="">
                        </div>
                        <div class="content-container">
                            <div class="header-flex">
                                <img id="poster" class="poster-img" src="">
                                <div style="flex: 1;">
                                    <div id="title" class="title">Anime Title</div>
                                    <div id="genres" class="genres"></div>
                                </div>
                            </div>
                            <div class="stats-box">
                                <div class="stat-item">
                                    <span class="stat-val"><i class="fa-solid fa-star" style="color:gold; font-size:14px;"></i> <span id="score">0.0</span></span>
                                    <span class="stat-label">Score</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-val"><span id="episodes">?</span></span>
                                    <span class="stat-label">Episodes</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-val"><span id="year">2023</span></span>
                                    <span class="stat-label">Year</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-val"><span id="type" style="text-transform:uppercase; font-size:14px;">TV</span></span>
                                    <span class="stat-label">Type</span>
                                </div>
                            </div>
                            <div class="action-card">
                                <div style="font-size: 13px; color: var(--text-muted); margin-bottom: 8px; font-weight:600;">Add to Watchlist</div>
                                <div class="form-group">
                                    <select id="statusSelect">
                                        <option value="watching">Watching</option>
                                        <option value="completed">Completed</option>
                                        <option value="plan">Plan to Watch</option>
                                        <option value="dropped">Dropped</option>
                                    </select>
                                    <button id="addBtn" class="add-btn">
                                        <i class="fa-solid fa-plus"></i> Add
                                    </button>
                                </div>
                            </div>
                            <div class="synopsis-area">
                                <div class="section-title">Synopsis</div>
                                <p id="synopsis" class="synopsis-text">Description loading...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Watchlist Page -->
            <div id="watchlistPage" class="page">
                <div class="page-container">
                    <div class="filter-container">
                        <button class="filter-btn active" data-filter="all"><i class="fa-solid fa-layer-group"></i> All</button>
                        <button class="filter-btn" data-filter="watching"><i class="fa-solid fa-eye"></i> Watching</button>
                        <button class="filter-btn" data-filter="completed"><i class="fa-solid fa-check-circle"></i> Done</button>
                        <button class="filter-btn" data-filter="plan"><i class="fa-solid fa-clock"></i> Plan</button>
                    </div>
                    <div id="watchlistLoading" class="text-center" style="margin-top:50px;"><i class="fa-solid fa-circle-notch fa-spin" style="font-size:30px; color:var(--primary);"></i></div>
                    <div id="listContainer"></div>
                    <div id="emptyState" class="hidden text-center" style="margin-top:50px; color:#999;"><i class="fa-solid fa-box-open" style="font-size:50px; margin-bottom:15px; color:#ddd;"></i><p style="font-weight:600;">List is empty</p></div>
                </div>
            </div>

            <!-- Poll Page -->
            <div id="pollPage" class="page">
                <div class="page-container">
                    <div id="pollsContainer">
                        <div id="pollLoading" class="text-center" style="margin-top:50px;">
                            <i class="fa-solid fa-circle-notch fa-spin" style="font-size:30px; color:var(--primary);"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Chat Page -->
            <div id="chatPage" class="page">
                <div id="inboxView" style="width: 100%; height: 100%; display: flex; flex-direction: column;">
                    <div class="tabs-slot">
                        <div class="chat-tabs">
                            <button class="chat-tab active" id="tab-private">Private</button>
                            <button class="chat-tab" id="tab-groups">Groups</button>
                        </div>
                    </div>
                    <div class="list-container" style="flex: 1; overflow-y: auto; padding: 15px; padding-bottom: 90px;">
                        <div id="privateList"></div>
                        <div id="groupsList" style="display:none;"></div>
                    </div>
                    <button class="fab-btn" id="fabButton"><i class="fa-solid fa-plus"></i></button>
                </div>
            </div>

            <!-- Profile Page -->
            <div id="profilePage" class="page">
                <div class="page-container" style="padding: 0;">
                    <div class="profile-banner" id="profileBanner">
                        <div class="edit-banner-btn" id="editBannerBtn"><i class="fa-solid fa-camera"></i> Edit</div>
                        <input type="file" id="bannerUpload" hidden accept="image/*">
                    </div>
                    <div class="profile-container">
                        <div class="avatar-wrapper">
                            <img id="profilePic" src="https://via.placeholder.com/150" class="profile-avatar">
                            <div class="edit-avatar-badge" id="editProfileBtn">
                                <i class="fa-solid fa-pencil"></i>
                            </div>
                        </div>
                        <div class="user-name">
                            <span id="username">Loading...</span>
                            <span id="verificationBadge"></span>
                        </div>
                        <div class="user-id-badge" id="copyIdBtn">
                            ID: <span id="customId">...</span> <i class="fa-regular fa-copy" style="font-size: 11px; margin-left: 3px;"></i>
                        </div>
                        <p class="user-bio" id="userBio">No bio available.</p>
                        <div style="display:flex; justify-content:center; gap:10px; margin: 15px 0;">
                            <button id="followUserBtn" class="btn-primary hidden" style="width:110px;">Follow</button>
                            <button id="msgUserBtn" class="btn-primary hidden" style="width:50px; background:#333;"><i class="fa-solid fa-envelope"></i></button>
                        </div>
                        <!-- Like/Dislike Buttons -->
                        <div id="reactionArea" class="hidden" style="display:flex; justify-content:center; gap:15px; margin-top:10px;">
                            <button id="likeBtn" style="background:white; color:#aaa; padding:10px 18px; border-radius:30px; display:flex; gap:6px; align-items:center; box-shadow:0 3px 10px rgba(0,0,0,0.05); border:1px solid #eee;">
                                <i class="fa-solid fa-thumbs-up"></i> <span id="likeCount">0</span>
                            </button>
                            <button id="dislikeBtn" style="background:white; color:#aaa; padding:10px 18px; border-radius:30px; display:flex; gap:6px; align-items:center; box-shadow:0 3px 10px rgba(0,0,0,0.05); border:1px solid #eee;">
                                <i class="fa-solid fa-thumbs-down"></i> <span id="dislikeCount">0</span>
                            </button>
                        </div>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <span class="stat-num" id="animeCount">0</span>
                                <span class="stat-label">Anime</span>
                            </div>
                            <div class="stat-card">
                                <span class="stat-num" id="followerCount">0</span>
                                <span class="stat-label">Followers</span>
                            </div>
                            <div class="stat-card">
                                <span class="stat-num" id="followingCount">0</span>
                                <span class="stat-label">Following</span>
                            </div>
                        </div>
                        <!-- Public Watchlist Preview -->
                        <div id="watchlistPreviewArea" style="margin-top: 30px; text-align: left;">
                            <h4 style="color:var(--text-muted); font-size:14px; margin-bottom:12px; font-weight:700;">RECENTLY ADDED</h4>
                            <div id="watchlistPreview" class="watchlist-preview"></div>
                        </div>
                        <div class="action-list" id="profileActions">
                            <div class="menu-btn" id="editProfileMenuBtn">
                                <span><i class="fa-solid fa-user-pen"></i> Edit Profile</span>
                                <i class="fa-solid fa-chevron-right" style="text-align: right;"></i>
                            </div>
                            <div class="menu-btn logout" id="logoutBtn">
                                <span><i class="fa-solid fa-right-from-bracket"></i> Logout</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <a href="javascript:void(0)" id="navHome" class="nav-item active"><i class="fa-solid fa-compass"></i><span>Home</span></a>
            <a href="javascript:void(0)" id="navWatchlist" class="nav-item"><i class="fa-solid fa-bookmark"></i><span>List</span></a>
            <a href="javascript:void(0)" id="navPoll" class="nav-item"><i class="fa-solid fa-chart-pie"></i><span>Polls</span></a>
            <a href="javascript:void(0)" id="navChat" class="nav-item"><i class="fa-solid fa-comments"></i><span>Chat</span></a>
            <a href="javascript:void(0)" id="navProfile" class="nav-item"><i class="fa-solid fa-user"></i><span>Profile</span></a>
        </nav>
    </div>

    <!-- Chat Room View (Overlay) -->
    <div id="chatRoomView" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 5000; display: flex; flex-direction: column; transform: translateX(100%); transition: transform 0.3s cubic-bezier(0.25, 1, 0.5, 1);">
        <div class="chat-header">
            <button id="closeChatBtn" style="background:none; border:none; color:var(--text-heading); font-size:20px; margin-right:5px;">
                <i class="fa-solid fa-arrow-left"></i>
            </button>
            <img id="headerAvatar" src="" class="chat-avatar" style="width:42px; height:42px; border-radius:50%; object-fit:cover;">
            <div style="flex:1; margin-left: 12px; cursor:pointer;" id="chatHeaderInfo">
                <div id="headerName" style="font-weight:700; font-size:16px; color:var(--text-heading);">Loading...</div>
                <div id="headerSub" style="font-size:11px; color:var(--text-muted);">ID: ...</div>
            </div>
        </div>
        <div id="messageContainer" class="chat-messages"></div>
        <div class="chat-input-area">
            <input type="text" id="msgInput" class="search-box" style="margin:0; flex:1;" placeholder="Type a message...">
            <button id="sendBtn" class="send-btn">
                <i class="fa-solid fa-paper-plane"></i>
            </button>
        </div>
    </div>

    <!-- Modals -->
    <!-- Forgot Password Modal -->
    <div id="forgotPasswordModal" class="modal-overlay">
        <div class="modal-box">
            <h3>Reset Password</h3>
            <p style="color:var(--text-muted); font-size:13px; margin-bottom:20px;">Enter your email to receive a reset link.</p>
            <input type="email" id="resetEmailInput" class="modal-inp" placeholder="your@email.com">
            <div style="display:flex; gap:10px;">
                <button id="sendResetBtn" class="btn-primary" style="flex:1">Send Link</button>
                <button id="closeResetModalBtn" style="flex:1; background:transparent; color:var(--text-muted); border:1px solid #ddd; border-radius:var(--radius-btn);">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Search User/Group Modal -->
    <div id="searchModal" class="modal-overlay">
        <div class="modal-box">
            <h3>New Chat</h3>
            <p style="font-size:13px; color:var(--text-muted); margin-bottom:15px;">Search by User ID or Group Username</p>
            <input type="text" id="searchIdInput" class="modal-inp" placeholder="User ID or GroupName_Group">
            <div style="display:flex; gap:10px; margin-top:10px;">
                <button id="searchUserBtn" class="btn-primary" style="flex:1">Find</button>
                <button id="closeSearchModalBtn" class="btn-primary" style="flex:1; background:#e0e0e0; color:#333; box-shadow:none;">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Create Group Modal -->
    <div id="createGroupModal" class="modal-overlay">
        <div class="modal-box">
            <h3>Create Group</h3>
            <input type="text" id="groupNameInput" class="modal-inp" placeholder="Display Name">
            <input type="text" id="groupUsernameInput" class="modal-inp" placeholder="Username (ends with _Group)">
            <input type="text" id="groupBioInput" class="modal-inp" placeholder="Bio">
            <label style="font-size:12px; color:var(--text-muted); font-weight:600;">Group Photo</label>
            <input type="file" id="groupPhotoInput" accept="image/*">
            <label style="font-size:12px; color:var(--text-muted); font-weight:600;">Privacy</label>
            <select id="groupPrivacyInput" class="modal-inp" style="margin-bottom:20px;">
                <option value="public">Public (Auto Join)</option>
                <option value="private">Private (Admin Approval)</option>
            </select>
            <div style="display:flex; gap:10px; margin-top:10px;">
                <button id="createGroupBtn" class="btn-primary" style="flex:1">Create</button>
                <button id="closeGroupModalBtn" class="btn-primary" style="flex:1; background:#e0e0e0; color:#333; box-shadow:none;">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Group Settings Modal -->
    <div id="groupSettingsModal" class="modal-overlay">
        <div class="modal-box">
            <h3>Group Settings</h3>
            <div id="groupSettingsContent"></div>
            <button id="closeGroupSettingsBtn" style="width:100%; background:#e0e0e0; color:#333; padding:12px; border-radius:12px; margin-top:15px; font-weight:600;">Close</button>
        </div>
    </div>

    <!-- Create Poll Modal -->
    <div id="createPollModal" class="modal-overlay">
        <div class="modal-box">
            <h3>Create Poll</h3>
            <label style="font-size:12px; color:var(--text-muted); font-weight:600;">Question</label>
            <input type="text" id="pollQuestion" class="modal-inp" placeholder="e.g. Best Anime Arc?">
            <label style="font-size:12px; color:var(--text-muted); font-weight:600;">Options</label>
            <div class="option-inputs" id="optionList">
                <input type="text" class="modal-inp option-field" placeholder="Option 1">
                <input type="text" class="modal-inp option-field" placeholder="Option 2">
            </div>
            <button id="addOptionBtn" style="background:none; border:1px dashed #ccc; color:var(--text-muted); width:100%; padding:12px; border-radius:12px; margin-bottom:20px; cursor:pointer;">
                <i class="fa-solid fa-plus"></i> Add Option
            </button>
            <div style="display:flex; gap:10px;">
                <button id="createPollBtn" class="btn-primary" style="flex:1;">Post</button>
                <button id="closePollModalBtn" style="flex:1; background:transparent; color:var(--text-muted); border:1px solid #ddd; border-radius:var(--radius-btn);">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Rate Anime Modal -->
    <div id="rateModal" class="modal-overlay">
        <div class="modal-box">
            <h3>Rate Anime</h3>
            <p id="rateTitle" style="color: var(--text-muted); font-size: 13px; margin-bottom:15px;">Title</p>
            <input type="hidden" id="rateId">
            <select id="scoreSelector" style="width:100%; padding:12px; margin-bottom:20px;">
                <option value="0">No Score</option>
                <option value="10">(10) Masterpiece</option>
                <option value="9">(9) Great</option>
                <option value="8">(8) Very Good</option>
                <option value="7">(7) Good</option>
                <option value="6">(6) Fine</option>
                <option value="5">(5) Average</option>
            </select>
            <div style="display: flex; gap: 10px;">
                <button class="btn-primary" id="saveRatingBtn" style="flex:1;">Save</button>
                <button id="closeRateModalBtn" style="flex:1; background: transparent; color: var(--text-muted); border: 1px solid #ddd; border-radius: var(--radius-btn);">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Delete Anime Modal -->
    <div id="deleteModal" class="modal-overlay">
        <div class="modal-box">
            <div class="delete-icon-circle"><i class="fa-solid fa-trash" style="font-size: 28px;"></i></div>
            <h3 style="text-align:center;">Remove Anime?</h3>
            <p id="deleteTitle" style="color: var(--text-muted); font-size: 14px; margin-bottom: 30px; text-align:center;">Remove from your list?</p>
            <input type="hidden" id="deleteId">
            <div style="display: flex; gap: 10px;">
                <button id="confirmDeleteBtn" style="flex:1; padding: 14px; border-radius: var(--radius-btn); background: #ff5252; color: white; border: none; font-weight: bold; box-shadow:0 4px 10px rgba(255, 82, 82, 0.3);">Delete</button>
                <button id="closeDeleteModalBtn" style="flex:1; background: transparent; color: var(--text-muted); border: 1px solid #ddd; border-radius: var(--radius-btn);">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Edit Profile Modal -->
    <div id="editProfileModal" class="modal-overlay">
        <div class="modal-box">
            <h3>Edit Profile</h3>
            <div class="input-group">
                <label class="input-label">Username</label>
                <input type="text" id="editName" class="custom-input" placeholder="Enter name">
            </div>
            <div class="input-group">
                <label class="input-label">Profile Picture</label>
                <input type="file" id="editAvatarFile" accept="image/*">
            </div>
            <div class="input-group">
                <label class="input-label">Bio</label>
                <textarea id="editBio" class="custom-input" rows="3" placeholder="Tell us about yourself"></textarea>
            </div>
            <button id="saveProfileBtn" class="btn-primary" style="width: 100%; padding: 14px;">Save Changes</button>
            <button id="closeEditProfileModalBtn" style="width: 100%; background: transparent; color: var(--text-muted); margin-top: 10px; padding: 10px;">Cancel</button>
        </div>
    </div>
<!-- Z-Integration (module) -->
<script type="module" src="js/z-integration/app.js"></script>
<script type="module" src="js/z-integration/main.js"></script>
<script type="module" src="js/z-integration/system.js"></script>
</body>
</html>